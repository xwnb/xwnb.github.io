<!-- build time:Sun Nov 07 2021 13:48:17 GMT+0000 (Coordinated Universal Time) --><!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><meta name="theme-color" content="#222"><meta name="generator" content="Hexo 4.2.1"><link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png"><link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png"><link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png"><link rel="mask-icon" href="/images/logo.svg" color="#222"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link rel="stylesheet" href="/css/main.css"><link rel="stylesheet" href="//fonts.googleapis.com/css?family=Helvetica Neue, Helvetica, Hiragino Sans GB, Microsoft YaHei, Source Han Sans CN, WenQuanYi Micro Hei, Arial, sans-serif:300,300italic,400,400italic,700,700italic|Consolas, Monaco, Menlo, monospace:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext"><link rel="stylesheet" href="/lib/font-awesome/css/all.min.css"><link rel="stylesheet" href="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.css"><script id="hexo-configurations">var NexT=window.NexT||{},CONFIG={hostname:"xwnb.github.io",root:"/",scheme:"Gemini",version:"7.8.0",exturl:!1,sidebar:{position:"left",display:"post",padding:18,offset:12,onmobile:!1},copycode:{enable:!0,show_result:!0,style:"flat"},back2top:{enable:!0,sidebar:!1,scrollpercent:!0},bookmark:{enable:!0,color:"#222",save:"auto"},fancybox:!0,mediumzoom:!1,lazyload:!0,pangu:!1,comments:{style:"tabs",active:null,storage:!0,lazyload:!1,nav:null},algolia:{hits:{per_page:10},labels:{input_placeholder:"Search for Posts",hits_empty:"We didn't find any results for the search: ${query}",hits_stats:"${hits} results found in ${time} ms"}},localsearch:{enable:!0,trigger:"auto",top_n_per_article:1,unescape:!1,preload:!1},motion:{enable:!0,async:!1,transition:{post_block:"fadeIn",post_header:"slideDownIn",post_body:"slideDownIn",coll_header:"slideLeftIn",sidebar:"slideUpIn"}},path:"search.xml"}</script><meta name="description" content="原文链接：CTR50-CPP. 保证容器索引和迭代器在有效范围内https:&#x2F;&#x2F;wiki.sei.cmu.edu&#x2F;confluence&#x2F;display&#x2F;cplusplus&#x2F;CTR50-CPP.+Guarantee+that+container+indices+and+iterators+are+within+the+valid+range"><meta property="og:type" content="article"><meta property="og:title" content="CTR50-CPP. 保证容器索引和迭代器在有效范围内"><meta property="og:url" content="https://xwnb.github.io/posts/2396132143/index.html"><meta property="og:site_name" content="Sun of Beach"><meta property="og:description" content="原文链接：CTR50-CPP. 保证容器索引和迭代器在有效范围内https:&#x2F;&#x2F;wiki.sei.cmu.edu&#x2F;confluence&#x2F;display&#x2F;cplusplus&#x2F;CTR50-CPP.+Guarantee+that+container+indices+and+iterators+are+within+the+valid+range"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://wiki.sei.cmu.edu/confluence/download/attachments/88046682/button_arrow_left.png?version=1&amp;modificationDate=1216910800000&amp;api=v2"><meta property="og:image" content="https://wiki.sei.cmu.edu/confluence/download/attachments/88046682/button_arrow_up.png?version=1&amp;modificationDate=1216910618000&amp;api=v2"><meta property="og:image" content="https://wiki.sei.cmu.edu/confluence/download/attachments/88046682/button_arrow_right.png?version=1&amp;modificationDate=1216910815000&amp;api=v2"><meta property="article:published_time" content="2020-06-25T04:03:05.000Z"><meta property="article:modified_time" content="2021-11-07T13:47:54.185Z"><meta property="article:author" content="村口最靓的 小Xu"><meta property="article:tag" content="SEI CERT C++"><meta property="article:tag" content="编码规范"><meta property="article:tag" content="翻译"><meta property="article:tag" content="CERT Containers"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://wiki.sei.cmu.edu/confluence/download/attachments/88046682/button_arrow_left.png?version=1&amp;modificationDate=1216910800000&amp;api=v2"><link rel="canonical" href="https://xwnb.github.io/posts/2396132143/"><script id="page-configurations">CONFIG.page={sidebar:"",isHome:!1,isPost:!0,lang:"zh-CN"}</script><link rel="stylesheet" href="//cdn.jsdelivr.net/gh/theme-next/theme-next-needmoreshare2@1/needsharebutton.min.css"><style>#needsharebutton-float{bottom:88px;cursor:pointer;left:-8px;position:fixed;z-index:9999}#needsharebutton-float .btn{border:1px solid $btn-default-border-color;border-radius:4px;padding:0 10px 0 14px}</style><title>CTR50-CPP. 保证容器索引和迭代器在有效范围内 | Sun of Beach</title><noscript><style>.sidebar-inner,.use-motion .brand,.use-motion .collection-header,.use-motion .comments,.use-motion .menu-item,.use-motion .pagination,.use-motion .post-block,.use-motion .post-body,.use-motion .post-header{opacity:initial}.use-motion .site-subtitle,.use-motion .site-title{opacity:initial;top:initial}.use-motion .logo-line-before i{left:initial}.use-motion .logo-line-after i{right:initial}</style></noscript><link rel="alternate" href="/atom.xml" title="Sun of Beach" type="application/atom+xml"></head><body itemscope itemtype="http://schema.org/WebPage"><div class="container use-motion"><div class="headband"></div><header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="header-inner"><div class="site-brand-container"><div class="site-nav-toggle"><div class="toggle" aria-label="切换导航栏"><span class="toggle-line toggle-line-first"></span> <span class="toggle-line toggle-line-middle"></span> <span class="toggle-line toggle-line-last"></span></div></div><div class="site-meta"><a href="/" class="brand" rel="start"><span class="logo-line-before"><i></i></span><h1 class="site-title">Sun of Beach</h1><span class="logo-line-after"><i></i></span></a><p class="site-subtitle" itemprop="description">Stay Angry, Stay Foolish</p></div><div class="site-nav-right"><div class="toggle popup-trigger"><i class="fa fa-search fa-fw fa-lg"></i></div></div></div><nav class="site-nav"><ul id="menu" class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a></li><li class="menu-item menu-item-commonweal"><a href="/404/" rel="section"><i class="fa fa-heartbeat fa-fw"></i>公益 404</a></li><li class="menu-item menu-item-search"><a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索</a></li></ul></nav><div class="search-pop-overlay"><div class="popup search-popup"><div class="search-header"><span class="search-icon"><i class="fa fa-search"></i></span><div class="search-input-container"><input autocomplete="off" autocapitalize="off" placeholder="搜索..." spellcheck="false" type="search" class="search-input"></div><span class="popup-btn-close"><i class="fa fa-times-circle"></i></span></div><div id="search-result"><div id="no-result"><i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i></div></div></div></div></div></header><div class="back-to-top"><i class="fa fa-arrow-up"></i> <span>0%</span></div><div class="reading-progress-bar"></div><a role="button" class="book-mark-link book-mark-link-fixed"></a> <a href="https://github.com/xwnb" class="github-corner" title="Follow me on GitHub" aria-label="Follow me on GitHub" rel="noopener" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin:130px 106px" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a><main class="main"><div class="main-inner"><div class="content-wrap"><div class="content post posts-expand"><article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN"><link itemprop="mainEntityOfPage" href="https://xwnb.github.io/posts/2396132143/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/profile-picture.jpg"><meta itemprop="name" content="村口最靓的 小Xu"><meta itemprop="description" content="个人站，学习记录、实践教程、资料收集等，哈哈哈。"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="Sun of Beach"></span><header class="post-header"><h1 class="post-title" itemprop="name headline">CTR50-CPP. 保证容器索引和迭代器在有效范围内</h1><div class="post-meta"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar"></i> </span><span class="post-meta-item-text">发表于</span> <time title="创建时间：2020-06-25 04:03:05" itemprop="dateCreated datePublished" datetime="2020-06-25T04:03:05+00:00">2020-06-25</time> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar-check"></i> </span><span class="post-meta-item-text">更新于</span> <time title="修改时间：2021-11-07 13:47:54" itemprop="dateModified" datetime="2021-11-07T13:47:54+00:00">2021-11-07</time> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-folder"></i> </span><span class="post-meta-item-text">分类于</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/SEI-CERT-C/" itemprop="url" rel="index"><span itemprop="name">SEI CERT C++</span></a> </span></span><span class="post-meta-item" title="阅读次数" id="busuanzi_container_page_pv" style="display:none"><span class="post-meta-item-icon"><i class="fa fa-eye"></i> </span><span class="post-meta-item-text">阅读次数：</span> <span id="busuanzi_value_page_pv"></span></span><br><span class="post-meta-item" title="本文字数"><span class="post-meta-item-icon"><i class="far fa-file-word"></i> </span><span class="post-meta-item-text">本文字数：</span> <span>5.6k</span> </span><span class="post-meta-item" title="阅读时长"><span class="post-meta-item-icon"><i class="far fa-clock"></i> </span><span class="post-meta-item-text">阅读时长 &asymp;</span> <span>5 分钟</span></span></div></header><div class="post-body" itemprop="articleBody"><p>原文链接：</p><p><a href="https://wiki.sei.cmu.edu/confluence/display/cplusplus/CTR50-CPP.+Guarantee+that+container+indices+and+iterators+are+within+the+valid+range" target="_blank" rel="noopener">CTR50-CPP. 保证容器索引和迭代器在有效范围内</a></p><p><a href="https://wiki.sei.cmu.edu/confluence/display/cplusplus/CTR50-CPP.+Guarantee+that+container+indices+and+iterators+are+within+the+valid+range" target="_blank" rel="noopener">https://wiki.sei.cmu.edu/confluence/display/cplusplus/CTR50-CPP.+Guarantee+that+container+indices+and+iterators+are+within+the+valid+range</a></p><a id="more"></a><p>保证数据引用在数据的边界范围内是程序员一定要负全责的。同理，当程序员使用标准模板容器库，也需要确保索引在容器范围之内。</p><p>Ensuring that array references are within the bounds of the array is almost entirely the responsibility of the programmer. Likewise, when using standard template library vectors, the programmer is responsible for ensuring integer indexes are within the bounds of the vector.</p><h2 id="不合规代码示例（指针）-Noncompliant-Code-Example-Pointers"><a class="header-anchor" href="#不合规代码示例（指针）-Noncompliant-Code-Example-Pointers">¶</a>不合规代码示例（指针） Noncompliant Code Example (Pointers)</h2><p>这个不合规代码示例展示了一个函数，<code>insert_in_table()</code>，包含两个 <code>int</code> 参数，<code>pos</code> 和 <code>value</code>，会受来自不可信源的数据影响。函数执行了范围检查以确保 <code>pos</code> 不会超出数组的上界，由 <code>tableSize</code> 指定，但是未检查下界。因为 <code>pos</code> 被声明为一个 (signed) <code>int</code>，这个参数可以设想为一个负数，导致一次超出 <code>table</code> 引用的内存范围的写入。</p><p>This noncompliant code example shows a function, <code>insert_in_table()</code>, that has two <code>int</code> parameters, <code>pos</code> and <code>value</code>, both of which can be influenced by data originating from untrusted sources. The function performs a range check to ensure that <code>pos</code> does not exceed the upper bound of the array, specified by <code>tableSize</code>, but fails to check the lower bound. Because <code>pos</code> is declared as a (signed) <code>int</code>, this parameter can assume a negative value, resulting in a write outside the bounds of the memory referenced by <code>table</code>.</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstddef&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">insert_in_table</span><span class="params">(<span class="keyword">int</span> *table, <span class="built_in">std</span>::<span class="keyword">size_t</span> tableSize, <span class="keyword">int</span> pos, <span class="keyword">int</span> value)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (pos &gt;= tableSize) &#123;</span><br><span class="line">    <span class="comment">// Handle error</span></span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  table[pos] = value;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="合规的方案-size-t-Compliant-Solution-size-t"><a class="header-anchor" href="#合规的方案-size-t-Compliant-Solution-size-t">¶</a>合规的方案 (<code>size_t</code>) Compliant Solution (<code>size_t</code>)</h2><p>这个合规的方案中，参数 <code>pos</code> 被声明为 <code>size_t</code>，可以避免传入负值变量。</p><p>In this compliant solution, the parameter <code>pos</code> is declared as <code>size_t</code>, which prevents the passing of negative arguments.</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstddef&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">insert_in_table</span><span class="params">(<span class="keyword">int</span> *table, <span class="built_in">std</span>::<span class="keyword">size_t</span> tableSize, <span class="built_in">std</span>::<span class="keyword">size_t</span> pos, <span class="keyword">int</span> value)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (pos &gt;= tableSize) &#123;</span><br><span class="line">    <span class="comment">// Handle error</span></span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  table[pos] = value;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="合规的方案-Non-Type-Templates-Compliant-Solution-Non-Type-Templates"><a class="header-anchor" href="#合规的方案-Non-Type-Templates-Compliant-Solution-Non-Type-Templates">¶</a>合规的方案 (Non-Type Templates) Compliant Solution (Non-Type Templates)</h2><p>无类型模板可以被用来定义接收一个数组类型的函数，数组边界可以编译器推导。这个合规的方案与先前需要在调用 <code>insert_in_table</code> 时额外提供一个已知边界的边界检查方案，在功能上等价的。</p><p>Non-type templates can be used to define functions accepting an array type where the array bounds are deduced at compile time. This compliant solution is functionally equivalent to the previous bounds-checking one except that it additionally supports calling <code>insert_in_table()</code> with an array of known bounds.</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstddef&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;new&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">insert_in_table</span><span class="params">(<span class="keyword">int</span> *table, <span class="built_in">std</span>::<span class="keyword">size_t</span> tableSize, <span class="built_in">std</span>::<span class="keyword">size_t</span> pos, <span class="keyword">int</span> value)</span> </span>&#123; <span class="comment">// #1</span></span><br><span class="line">  <span class="keyword">if</span> (pos &gt;= tableSize) &#123;</span><br><span class="line">    <span class="comment">// Handle error</span></span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  table[pos] = value;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="built_in">std</span>::<span class="keyword">size_t</span> N&gt;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">insert_in_table</span><span class="params">(<span class="keyword">int</span> (&amp;table)[N], <span class="built_in">std</span>::<span class="keyword">size_t</span> pos, <span class="keyword">int</span> value)</span> </span>&#123; <span class="comment">// #2</span></span><br><span class="line">  insert_in_table(table, N, pos, value);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">f</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="comment">// Exposition only</span></span><br><span class="line">  <span class="keyword">int</span> table1[<span class="number">100</span>];</span><br><span class="line">  <span class="keyword">int</span> *table2 = <span class="keyword">new</span> <span class="keyword">int</span>[<span class="number">100</span>];</span><br><span class="line">  insert_in_table(table1, <span class="number">0</span>, <span class="number">0</span>); <span class="comment">// Calls #2</span></span><br><span class="line">  insert_in_table(table2, <span class="number">0</span>, <span class="number">0</span>); <span class="comment">// Error, no matching function call</span></span><br><span class="line">  insert_in_table(table1, <span class="number">100</span>, <span class="number">0</span>, <span class="number">0</span>); <span class="comment">// Calls #1</span></span><br><span class="line">  insert_in_table(table2, <span class="number">100</span>, <span class="number">0</span>, <span class="number">0</span>); <span class="comment">// Calls #1</span></span><br><span class="line">  <span class="keyword">delete</span> [] table2;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="不合规代码示例-std-vector-Noncompliant-Code-Example-std-vector"><a class="header-anchor" href="#不合规代码示例-std-vector-Noncompliant-Code-Example-std-vector">¶</a>不合规代码示例 (<code>std::vector</code>) Noncompliant Code Example (<code>std::vector</code>)</h2><p>在这个不合规的代码示例中，<code>std::vector</code> 被用来替换指针和尺寸。这个函数执行一次范围检查确保 <code>pos</code> 不会超出容器的上边界。因为 <code>pos</code> 被声明为一个 (signed) <code>long long</code>，这个参数可以是负数。在把 <code>std::vector::size_type</code> 以 <code>unsigned int</code> 来实现的系统中 (例如 <a href="https://wiki.sei.cmu.edu/confluence/display/cplusplus/BB.+Definitions#BB.Definitions-msvc" target="_blank" rel="noopener">Microsoft Visual Studio</a>2013)，对于比较表达式，一般的算数转换会被用来将无符号值转换为有符号值。如果 <code>pos</code> 是一个负值， 这次比较将不会失败，当负值在索引操作中被解释为一个大的无符号值，将导致一次 <code>std::vector</code> 对象的越界写入。</p><p>In this noncompliant code example, a <code>std::vector</code> is used in place of a pointer and size pair. The function performs a range check to ensure that <code>pos</code> does not exceed the upper bound of the container. Because <code>pos</code> is declared as a (signed) <code>long long</code>, this parameter can assume a negative value. On systems where <code>std::vector::size_type</code> is ultimately implemented as an <code>unsigned int</code> (such as with <a href="https://wiki.sei.cmu.edu/confluence/display/cplusplus/BB.+Definitions#BB.Definitions-msvc" target="_blank" rel="noopener">Microsoft Visual Studio</a>2013), the usual arithmetic conversions applied for the comparison expression will convert the unsigned value to a signed value. If <code>pos</code> has a negative value, this comparison will not fail, resulting in a write outside the bounds of the <code>std::vector</code> object when the negative value is interpreted as a large unsigned value in the indexing operator.</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">insert_in_table</span><span class="params">(<span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; &amp;table, <span class="keyword">long</span> <span class="keyword">long</span> pos, <span class="keyword">int</span> value)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (pos &gt;= table.<span class="built_in">size</span>()) &#123;</span><br><span class="line">    <span class="comment">// Handle error</span></span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  table[pos] = value;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="合规方案-std-vector-size-t-Compliant-Solution-std-vector-size-t"><a class="header-anchor" href="#合规方案-std-vector-size-t-Compliant-Solution-std-vector-size-t">¶</a>合规方案 (<code>std::vector</code>, <code>size_t</code>) Compliant Solution (<code>std::vector</code>, <code>size_t</code>)</h2><p>在这个合规的方案中，参数 <code>pos</code> 被声明为 <code>size_t</code>，确保了当给定一个大的正数 (从一个负数变量转换而来)， 比较表达式执行失败。</p><p>In this compliant solution, the parameter <code>pos</code> is declared as <code>size_t</code>, which ensures that the comparison expression will fail when a large, positive value (converted from a negative argument) is given.</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">insert_in_table</span><span class="params">(<span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; &amp;table, <span class="built_in">std</span>::<span class="keyword">size_t</span> pos, <span class="keyword">int</span> value)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (pos &gt;= table.<span class="built_in">size</span>()) &#123;</span><br><span class="line">    <span class="comment">// Handle error</span></span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  table[pos] = value;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="合规的方案-std-vector-at-Compliant-Solution-std-vector-at"><a class="header-anchor" href="#合规的方案-std-vector-at-Compliant-Solution-std-vector-at">¶</a>合规的方案 (<code>std::vector::at()</code>) Compliant Solution (<code>std::vector::at()</code>)</h2><p>这个合规的方案中，通过 <code>at()</code> 方法来访问容器。这个方案提供了边界检查，如果 <code>pos</code> 不是一个有效的索引值时，抛出一个 <code>std::out_of_range</code> 异常。<code>insert_in_table()</code> 被定义为一个 <code>noexcept(false)</code> 函数，符合 <a href="https://wiki.sei.cmu.edu/confluence/display/cplusplus/ERR55-CPP.+Honor+exception+specifications" target="_blank" rel="noopener">ERR55-CPP. Honor exception specifications</a> 。</p><p>In this compliant solution, access to the vector is accomplished with the <code>at()</code> method. This method provides bounds checking, throwing a <code>std::out_of_range</code> exception if <code>pos</code> is not a valid index value. The <code>insert_in_table()</code> function is declared with <code>noexcept(false)</code> in compliance with <a href="https://wiki.sei.cmu.edu/confluence/display/cplusplus/ERR55-CPP.+Honor+exception+specifications" target="_blank" rel="noopener">ERR55-CPP. Honor exception specifications</a>.</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">insert_in_table</span><span class="params">(<span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; &amp;table, <span class="built_in">std</span>::<span class="keyword">size_t</span> pos, <span class="keyword">int</span> value)</span> <span class="title">noexcept</span><span class="params">(<span class="literal">false</span>)</span> </span>&#123;</span><br><span class="line">  table.at(pos) = value;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="不合规代码示例-Iterrators-Noncompliant-Code-Example-Iterators"><a class="header-anchor" href="#不合规代码示例-Iterrators-Noncompliant-Code-Example-Iterators">¶</a>不合规代码示例 (Iterrators) Noncompliant Code Example (Iterators)</h2><p>在这个不合规的代码示例中，函数 <code>f_imp()</code> 给定了 (正确的) 容器尾迭代器 <code>e</code>，<code>b</code> 是同个容器的迭代器。然而，<code>b</code> 不在该容器的有效范围内也是有可能的。举个例子，如果容器是空的，<code>b</code> 将和 <code>e</code> 相等，导致不正确的引用。</p><p>In this noncompliant code example, the <code>f_imp()</code> function is given the (correct) ending iterator <code>e</code> for a container, and <code>b</code> is an iterator from the same container. However, it is possible that <code>b</code> is not within the valid range of its container. For instance, if the container were empty, <code>b</code> would equal <code>e</code> and be improperly dereferenced.</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iterator&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> ForwardIterator&gt;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">f_imp</span><span class="params">(ForwardIterator b, ForwardIterator e, <span class="keyword">int</span> val, <span class="built_in">std</span>::forward_iterator_tag)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">do</span> &#123;</span><br><span class="line">    *b++ = val;</span><br><span class="line">  &#125; <span class="keyword">while</span> (b != e);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> ForwardIterator&gt;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">f</span><span class="params">(ForwardIterator b, ForwardIterator e, <span class="keyword">int</span> val)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">typename</span> <span class="built_in">std</span>::iterator_traits&lt;ForwardIterator&gt;::iterator_category cat;</span><br><span class="line">  f_imp(b, e, val, cat);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="合规方案-Compliant-Solution"><a class="header-anchor" href="#合规方案-Compliant-Solution">¶</a>合规方案 Compliant Solution</h2><p>这个合规方案在试图解引用 <code>b</code> 前对迭代器有效性做了测试。</p><p>This compliant solution tests for iterator validity before attempting to dereference <code>b.</code></p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iterator&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> ForwardIterator&gt;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">f_imp</span><span class="params">(ForwardIterator b, ForwardIterator e, <span class="keyword">int</span> val, <span class="built_in">std</span>::forward_iterator_tag)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">while</span> (b != e) &#123;</span><br><span class="line">    *b++ = val;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> ForwardIterator&gt;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">f</span><span class="params">(ForwardIterator b, ForwardIterator e, <span class="keyword">int</span> val)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">typename</span> <span class="built_in">std</span>::iterator_traits&lt;ForwardIterator&gt;::iterator_category cat;</span><br><span class="line">  f_imp(b, e, val, cat);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="Risk-Assessment"><a class="header-anchor" href="#Risk-Assessment">¶</a>Risk Assessment</h2><p>Using an invalid array or container index can result in an arbitrary memory overwrite or <a href="https://wiki.sei.cmu.edu/confluence/display/cplusplus/BB.+Definitions#BB.Definitions-abnormaltermination" target="_blank" rel="noopener">abnormal program termination</a>.</p><table><thead><tr><th style="text-align:left">Rule</th><th style="text-align:left">Severity</th><th style="text-align:left">Likelihood</th><th style="text-align:left">Remediation Cost</th><th style="text-align:left">Priority</th><th style="text-align:left">Level</th></tr></thead><tbody><tr><td style="text-align:left">CTR50-CPP</td><td style="text-align:left">High</td><td style="text-align:left">Likely</td><td style="text-align:left">High</td><td style="text-align:left"><strong>P9</strong></td><td style="text-align:left"><strong>L2</strong></td></tr></tbody></table><h2 id="Automated-Detection"><a class="header-anchor" href="#Automated-Detection">¶</a>Automated Detection</h2><table><thead><tr><th style="text-align:left">Tool</th><th style="text-align:left">Version</th><th style="text-align:left">Checker</th><th style="text-align:left">Description</th></tr></thead><tbody><tr><td style="text-align:left"><a href="https://wiki.sei.cmu.edu/confluence/display/cplusplus/CodeSonar" target="_blank" rel="noopener">CodeSonar</a></td><td style="text-align:left">5.3p0</td><td style="text-align:left">**<a href="http://LANG.MEM.BO" target="_blank" rel="noopener">LANG.MEM.BO</a> LANG.MEM.BU <a href="http://LANG.MEM.TO" target="_blank" rel="noopener">LANG.MEM.TO</a> LANG.MEM.TU **<strong>LANG.MEM.TBA *</strong>*LANG.STRUCT.PBB ****LANG.STRUCT.PPE**</td><td style="text-align:left">Buffer overrun Buffer underrun Type overrun Type underrun Tainted buffer access Pointer before beginning of object Pointer past end of object</td></tr><tr><td style="text-align:left"><a href="https://www.securecoding.cert.org/confluence/display/cplusplus/Klocwork" target="_blank" rel="noopener">Klocwork</a></td><td style="text-align:left">2018</td><td style="text-align:left"><strong><a href="https://support.roguewave.com/documentation/klocwork/en/current/certcandcsecurecodingstandardidsmappedtoklocworkcandccheckers/" target="_blank" rel="noopener">ABV.ANY_SIZE_ARRAY</a></strong> <strong><a href="https://support.roguewave.com/documentation/klocwork/en/current/certcandcsecurecodingstandardidsmappedtoklocworkcandccheckers/" target="_blank" rel="noopener">ABV.GENERAL</a></strong> <strong><a href="https://support.roguewave.com/documentation/klocwork/en/current/certcandcsecurecodingstandardidsmappedtoklocworkcandccheckers/" target="_blank" rel="noopener">ABV.STACK</a></strong> <strong><a href="https://support.roguewave.com/documentation/klocwork/en/current/certcandcsecurecodingstandardidsmappedtoklocworkcandccheckers/" target="_blank" rel="noopener">ABV.TAINTED</a></strong> <strong><a href="https://support.roguewave.com/documentation/klocwork/en/current/certcandcsecurecodingstandardidsmappedtoklocworkcandccheckers/" target="_blank" rel="noopener">SV.TAINTED.ALLOC_SIZE</a></strong> <strong><a href="https://support.roguewave.com/documentation/klocwork/en/current/certcandcsecurecodingstandardidsmappedtoklocworkcandccheckers/" target="_blank" rel="noopener">SV.TAINTED.CALL.INDEX_ACCESS</a></strong> <strong><a href="https://support.roguewave.com/documentation/klocwork/en/current/certcandcsecurecodingstandardidsmappedtoklocworkcandccheckers/" target="_blank" rel="noopener">SV.TAINTED.CALL.LOOP_BOUND</a></strong> <strong><a href="https://support.roguewave.com/documentation/klocwork/en/current/certcandcsecurecodingstandardidsmappedtoklocworkcandccheckers/" target="_blank" rel="noopener">SV.TAINTED.INDEX_ACCESS</a></strong></td><td style="text-align:left"></td></tr><tr><td style="text-align:left"><a href="https://wiki.sei.cmu.edu/confluence/display/cplusplus/LDRA" target="_blank" rel="noopener">LDRA tool suite</a></td><td style="text-align:left">9.7.1</td><td style="text-align:left"><strong>45 D, 47 S, 476 S, 489 S, 64 X, 66 X, 68 X, 69 X, 70 X, 71 X, 79 X**</strong> **</td><td style="text-align:left">Partially implemented</td></tr><tr><td style="text-align:left"><a href="https://wiki.sei.cmu.edu/confluence/display/cplusplus/Parasoft" target="_blank" rel="noopener">Parasoft C/C++test</a></td><td style="text-align:left">10.4.2</td><td style="text-align:left"><strong>CERT_CPP-CTR50-a</strong></td><td style="text-align:left">Guarantee that container indices are within the valid range</td></tr><tr><td style="text-align:left"><a href="https://wiki.sei.cmu.edu/confluence/display/cplusplus/Polyspace+Bug+Finder" target="_blank" rel="noopener">Polyspace Bug Finder</a></td><td style="text-align:left">R2020a</td><td style="text-align:left"><a href="https://www.mathworks.com/help/bugfinder/ref/certcctr50cpp.html" target="_blank" rel="noopener">CERT C++: CTR50-CPP</a></td><td style="text-align:left">Checks for:Array access out of boundsArray access with tainted indexPointer dereference with tainted offsetRule partially covered.</td></tr><tr><td style="text-align:left"><a href="https://wiki.sei.cmu.edu/confluence/pages/viewpage.action?pageId=88046345" target="_blank" rel="noopener">PRQA QA-C++</a></td><td style="text-align:left">4.4</td><td style="text-align:left"><strong>2891, 3139, 3140</strong></td><td style="text-align:left"></td></tr><tr><td style="text-align:left"><a href="https://wiki.sei.cmu.edu/confluence/display/cplusplus/PVS-Studio" target="_blank" rel="noopener">PVS-Studio</a></td><td style="text-align:left">7.07</td><td style="text-align:left"><strong><a href="https://www.viva64.com/en/w/v781/" target="_blank" rel="noopener">V781</a></strong></td><td style="text-align:left"></td></tr></tbody></table><h2 id="Related-Vulnerabilities"><a class="header-anchor" href="#Related-Vulnerabilities">¶</a>Related Vulnerabilities</h2><p>Search for <a href="https://wiki.sei.cmu.edu/confluence/display/cplusplus/BB.+Definitions#BB.Definitions-vulnerabi" target="_blank" rel="noopener">vulnerabilities</a> resulting from the violation of this rule on the <a href="https://www.kb.cert.org/vulnotes/bymetric?searchview&amp;query=FIELD+KEYWORDS+contains+CTR50-CPP" target="_blank" rel="noopener">CERT website</a>.</p><h2 id="Related-Guidelines"><a class="header-anchor" href="#Related-Guidelines">¶</a>Related Guidelines</h2><table><thead><tr><th><a href="https://wiki.sei.cmu.edu/confluence/display/c/SEI+CERT+C+Coding+Standard" target="_blank" rel="noopener">SEI CERT C Coding Standard</a></th><th><a href="https://wiki.sei.cmu.edu/confluence/display/c/ARR30-C.+Do+not+form+or+use+out-of-bounds+pointers+or+array+subscripts" target="_blank" rel="noopener">ARR30-C. Do not form or use out-of-bounds pointers or array subscripts</a></th></tr></thead><tbody><tr><td><a href="http://cwe.mitre.org/" target="_blank" rel="noopener">MITRE CWE</a></td><td><a href="http://cwe.mitre.org/data/definitions/119.html" target="_blank" rel="noopener">CWE 119</a>, Failure to Constrain Operations within the Bounds of a Memory Buffer <a href="http://cwe.mitre.org/data/definitions/129.html" target="_blank" rel="noopener">CWE 129</a>, Improper Validation of Array Index</td></tr></tbody></table><h2 id="Bibliography"><a class="header-anchor" href="#Bibliography">¶</a>Bibliography</h2><table><thead><tr><th>[<a href="https://wiki.sei.cmu.edu/confluence/display/cplusplus/AA.+Bibliography#AA.Bibliography-ISO/IEC14882-2014" target="_blank" rel="noopener">ISO/IEC 14882-2014</a>]</th><th>Clause 23, “Containers Library” Subclause 24.2.1, “In General”</th></tr></thead><tbody><tr><td>[<a href="https://wiki.sei.cmu.edu/confluence/display/cplusplus/AA.+Bibliography#AA.Bibliography-ISO/IECTR24772-2013" target="_blank" rel="noopener">ISO/IEC TR 24772-2013</a>]</td><td>Boundary Beginning Violation [XYX] Wrap-Around Error [XYY] Unchecked Array Indexing [XYZ]</td></tr><tr><td>[<a href="https://wiki.sei.cmu.edu/confluence/display/cplusplus/AA.+Bibliography#AA.Bibliography-Viega05" target="_blank" rel="noopener">Viega 2005</a>]</td><td>Section 5.2.13, “Unchecked Array Indexing”</td></tr></tbody></table><hr><p><a href="https://wiki.sei.cmu.edu/confluence/pages/viewpage.action?pageId=88046331" target="_blank" rel="noopener"><img data-src="https://wiki.sei.cmu.edu/confluence/download/attachments/88046682/button_arrow_left.png?version=1&amp;modificationDate=1216910800000&amp;api=v2" alt="img"></a><a href="https://wiki.sei.cmu.edu/confluence/pages/viewpage.action?pageId=88046331" target="_blank" rel="noopener"><img data-src="https://wiki.sei.cmu.edu/confluence/download/attachments/88046682/button_arrow_up.png?version=1&amp;modificationDate=1216910618000&amp;api=v2" alt="img"></a><a href="https://wiki.sei.cmu.edu/confluence/pages/viewpage.action?pageId=88046457" target="_blank" rel="noopener"><img data-src="https://wiki.sei.cmu.edu/confluence/download/attachments/88046682/button_arrow_right.png?version=1&amp;modificationDate=1216910815000&amp;api=v2" alt="img"></a></p></div><div class="popular-posts-header">推荐文章</div><ul class="popular-posts"><li class="popular-posts-item"><div class="popular-posts-title"><a href="/posts/505389678/" rel="bookmark">CTR58-CPP. 谓词函数对象不应该是 mutable</a></div></li><li class="popular-posts-item"><div class="popular-posts-title"><a href="/posts/2368459165/" rel="bookmark">CTR57-CPP. 提供一个有效排序的谓词</a></div></li><li class="popular-posts-item"><div class="popular-posts-title"><a href="/posts/1493253227/" rel="bookmark">CTR56-CPP. 不要在多态对象上使用指针运算</a></div></li></ul><div class="reward-container"><div></div><button onclick='var e=document.getElementById("qr");e.style.display="none"===e.style.display?"block":"none"'>打赏</button><div id="qr" style="display:none"><div style="display:inline-block"><img src="/images/wechatpay.jpg" alt="村口最靓的 小Xu 微信支付"><p>微信支付</p></div><div style="display:inline-block"><img src="/images/alipay.jpg" alt="村口最靓的 小Xu 支付宝"><p>支付宝</p></div></div></div><div><ul class="post-copyright"><li class="post-copyright-author"><strong>本文作者： </strong>村口最靓的 小Xu</li><li class="post-copyright-link"><strong>本文链接：</strong> <a href="https://xwnb.github.io/posts/2396132143/" title="CTR50-CPP. 保证容器索引和迭代器在有效范围内">https://xwnb.github.io/posts/2396132143/</a></li><li class="post-copyright-license"><strong>版权声明： </strong>本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="noopener" target="_blank"><i class="fab fa-fw fa-creative-commons"></i>BY-NC-SA</a> 许可协议。转载请注明出处！</li></ul></div><div class="followme"><p>欢迎关注我的其它发布渠道</p><div class="social-list"><div class="social-item"><a target="_blank" class="social-link" href="/images/wechat_channel.jpg"><span class="icon"><i class="fab fa-weixin"></i> </span><span class="label">WeChat</span></a></div><div class="social-item"><a target="_blank" class="social-link" href="/atom.xml"><span class="icon"><i class="fa fa-rss"></i> </span><span class="label">RSS</span></a></div><div class="social-item"><a target="_blank" class="social-link" href="https://blog.csdn.net/xiaowei1234565"><span class="icon"><i class="fab fa-blogger"></i> </span><span class="label">CSDN</span></a></div></div></div><footer class="post-footer"><div class="post-tags"><a href="/tags/SEI-CERT-C/" rel="tag"><i class="fa fa-tag"></i> SEI CERT C++</a> <a href="/tags/%E7%BC%96%E7%A0%81%E8%A7%84%E8%8C%83/" rel="tag"><i class="fa fa-tag"></i> 编码规范</a> <a href="/tags/%E7%BF%BB%E8%AF%91/" rel="tag"><i class="fa fa-tag"></i> 翻译</a> <a href="/tags/CERT-Containers/" rel="tag"><i class="fa fa-tag"></i> CERT Containers</a></div><div class="post-widgets"><div class="wp_rating"><div id="wpac-rating"></div></div></div><div class="post-nav"><div class="post-nav-item"><a href="/posts/39044419/" rel="prev" title="CTR51-CPP. 使用有效的引用，指针，迭代器来引用容器的元素"><i class="fa fa-chevron-left"></i> CTR51-CPP. 使用有效的引用，指针，迭代器来引用容器的元素</a></div><div class="post-nav-item"><a href="/posts/3114312552/" rel="next" title="SEI CERT C++ Coding Standard 学习及翻译计划">SEI CERT C++ Coding Standard 学习及翻译计划 <i class="fa fa-chevron-right"></i></a></div></div></footer></article></div><script>window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }</script></div><div class="toggle sidebar-toggle"><span class="toggle-line toggle-line-first"></span> <span class="toggle-line toggle-line-middle"></span> <span class="toggle-line toggle-line-last"></span></div><aside class="sidebar"><div class="sidebar-inner"><ul class="sidebar-nav motion-element"><li class="sidebar-nav-toc">文章目录</li><li class="sidebar-nav-overview">站点概览</li></ul><div class="post-toc-wrap sidebar-panel"><div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#不合规代码示例（指针）-Noncompliant-Code-Example-Pointers"><span class="nav-text">不合规代码示例（指针） Noncompliant Code Example (Pointers)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#合规的方案-size-t-Compliant-Solution-size-t"><span class="nav-text">合规的方案 (size_t) Compliant Solution (size_t)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#合规的方案-Non-Type-Templates-Compliant-Solution-Non-Type-Templates"><span class="nav-text">合规的方案 (Non-Type Templates) Compliant Solution (Non-Type Templates)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#不合规代码示例-std-vector-Noncompliant-Code-Example-std-vector"><span class="nav-text">不合规代码示例 (std::vector) Noncompliant Code Example (std::vector)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#合规方案-std-vector-size-t-Compliant-Solution-std-vector-size-t"><span class="nav-text">合规方案 (std::vector, size_t) Compliant Solution (std::vector, size_t)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#合规的方案-std-vector-at-Compliant-Solution-std-vector-at"><span class="nav-text">合规的方案 (std::vector::at()) Compliant Solution (std::vector::at())</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#不合规代码示例-Iterrators-Noncompliant-Code-Example-Iterators"><span class="nav-text">不合规代码示例 (Iterrators) Noncompliant Code Example (Iterators)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#合规方案-Compliant-Solution"><span class="nav-text">合规方案 Compliant Solution</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Risk-Assessment"><span class="nav-text">Risk Assessment</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Automated-Detection"><span class="nav-text">Automated Detection</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Related-Vulnerabilities"><span class="nav-text">Related Vulnerabilities</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Related-Guidelines"><span class="nav-text">Related Guidelines</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Bibliography"><span class="nav-text">Bibliography</span></a></li></ol></div></div><div class="site-overview-wrap sidebar-panel"><div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person"><img class="site-author-image" itemprop="image" alt="村口最靓的 小Xu" src="/images/profile-picture.jpg"><p class="site-author-name" itemprop="name">村口最靓的 小Xu</p><div class="site-description" itemprop="description">个人站，学习记录、实践教程、资料收集等，哈哈哈。</div></div><div class="site-state-wrap motion-element"><nav class="site-state"><div class="site-state-item site-state-posts"><a href="/archives/"><span class="site-state-item-count">34</span> <span class="site-state-item-name">日志</span></a></div><div class="site-state-item site-state-categories"><a href="/categories/"><span class="site-state-item-count">6</span> <span class="site-state-item-name">分类</span></a></div><div class="site-state-item site-state-tags"><a href="/tags/"><span class="site-state-item-count">23</span> <span class="site-state-item-name">标签</span></a></div></nav></div><div class="links-of-author motion-element"><span class="links-of-author-item"><a href="https://github.com/xwnb" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;xwnb" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a> </span><span class="links-of-author-item"><a href="/www.weibo.com" title="Weibo → www.weibo.com"><i class="fab fa-weibo fa-fw"></i>Weibo</a> </span><span class="links-of-author-item"><a href="/www.google.com" title="Google → www.google.com"><i class="fab fa-google fa-fw"></i>Google</a> </span><span class="links-of-author-item"><a href="https://www.zhihu.com/" title="Zhihu → https:&#x2F;&#x2F;www.zhihu.com" rel="noopener" target="_blank"><i class="fab fa-zhihu fa-fw"></i>Zhihu</a></span></div><div class="links-of-blogroll motion-element"><div class="links-of-blogroll-title"><i class="fa fa-link fa-fw"></i> Friend Links</div><ul class="links-of-blogroll-list"><li class="links-of-blogroll-item"><a href="https://blog.csdn.net/xiaowei1234565" title="https:&#x2F;&#x2F;blog.csdn.net&#x2F;xiaowei1234565" rel="noopener" target="_blank">CSDN</a></li><li class="links-of-blogroll-item"><a href="https://www.cnblogs.com/" title="https:&#x2F;&#x2F;www.cnblogs.com&#x2F;" rel="noopener" target="_blank">CNBLOGS</a></li><li class="links-of-blogroll-item"><a href="https://www.oschina.net/" title="https:&#x2F;&#x2F;www.oschina.net&#x2F;" rel="noopener" target="_blank">OSCHINA</a></li><li class="links-of-blogroll-item"><a href="https://www.v2ex.com/" title="https:&#x2F;&#x2F;www.v2ex.com&#x2F;" rel="noopener" target="_blank">V2EX</a></li></ul></div></div></div></aside><div id="sidebar-dimmer"></div></div></main><footer class="footer"><div class="footer-inner"><img src="http://ghchart.rshah.org/xwnb" alt="xwnb's Github chart"><div class="copyright">&copy; 2018 – <span itemprop="copyrightYear">2021</span> <span class="with-love"><i class="fa fa-user-circle"></i> </span><span class="author" itemprop="copyrightHolder">村口最靓的 小Xu</span> <span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-chart-area"></i> </span><span title="站点总字数">98k</span> <span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-coffee"></i> </span><span title="站点阅读时长">1:29</span></div><div class="busuanzi-count"><script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span class="post-meta-item" id="busuanzi_container_site_uv" style="display:none"><span class="post-meta-item-icon"><i class="fa fa-user"></i> </span><span class="site-uv" title="总访客量"><span id="busuanzi_value_site_uv"></span> </span></span><span class="post-meta-divider">|</span> <span class="post-meta-item" id="busuanzi_container_site_pv" style="display:none"><span class="post-meta-item-icon"><i class="fa fa-eye"></i> </span><span class="site-pv" title="总访问量"><span id="busuanzi_value_site_pv"></span></span></span></div></div></footer></div><script src="/lib/anime.min.js"></script><script src="//cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><script src="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.js"></script><script src="//cdn.jsdelivr.net/npm/lozad@1/dist/lozad.min.js"></script><script src="/lib/velocity/velocity.min.js"></script><script src="/lib/velocity/velocity.ui.min.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/schemes/pisces.js"></script><script src="/js/next-boot.js"></script><script src="/js/bookmark.js"></script><script>!function(){var e,t,o=document.getElementsByTagName("link");if(o.length>0)for(i=0;i<o.length;i++)"canonical"==o[i].rel.toLowerCase()&&o[i].href&&(e=o[i].href);t=e?e.split(":")[0]:window.location.protocol.split(":")[0],e||(e=window.location.href),!function(){var i=/([http|https]:\/\/[a-zA-Z0-9\_\.]+\.baidu\.com)/gi,o=e,r=document.referrer;if(!i.test(o)){var n="https"===String(t).toLowerCase()?"https://sp0.baidu.com/9_Q4simg2RQJ8t7jm9iCKT-xh_/s.gif":"//api.share.baidu.com/s.gif";r?(n+="?r="+encodeURIComponent(document.referrer),o&&(n+="&l="+o)):o&&(n+="?l="+o);var a=new Image;a.src=n}}(window)}()</script><script>if (CONFIG.page.isPost) {
    wpac_init = window.wpac_init || [];
    wpac_init.push({
      widget: 'Rating',
      id    : ,
      el    : 'wpac-rating',
      color : 'fc6423'
    });
    (function() {
      if ('WIDGETPACK_LOADED' in window) return;
      WIDGETPACK_LOADED = true;
      var mc = document.createElement('script');
      mc.type = 'text/javascript';
      mc.async = true;
      mc.src = '//embed.widgetpack.com/widget.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(mc, s.nextSibling);
    })();
  }</script><script src="/js/local-search.js"></script><script src="//cdn.jsdelivr.net/npm/quicklink@1/dist/quicklink.umd.js"></script><script>window.addEventListener('load', () => {
      quicklink({
        timeout : 3000,
        priority: true,
        ignores : [uri => uri.includes('#'),uri => uri === 'https://xwnb.github.io/posts/2396132143/',]
      });
      });</script><div id="needsharebutton-float"><span class="btn"><i class="fa fa-share-alt" aria-hidden="true"></i></span></div><script src="//cdn.jsdelivr.net/gh/theme-next/theme-next-needmoreshare2@1/needsharebutton.min.js"></script><script>flOptions={},flOptions.iconStyle="box",flOptions.boxForm="vertical",flOptions.position="middleRight",flOptions.networks="Weibo,Wechat,Douban,QQZone,Twitter,Facebook",new needShareButton("#needsharebutton-float",flOptions)</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.css"><div id="aplayer"></div><script src="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.js"></script><script src="https://cdn.jsdelivr.net/npm/meting@2/dist/Meting.min.js"></script><meting-js server="netease" type="playlist" id="60498371" autoplay fixed="true" mutex="true" order="random"></meting-js></body></html><!-- rebuild by neat -->